<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NERDSS: Associate</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NERDSS
   &#160;<span id="projectnumber">0.90</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Associate</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions specifically used for the association of two molecules.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:class___vector_8hpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class___vector_8hpp.html">class_Vector.hpp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:class___vector_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class___vector_8cpp.html">class_Vector.cpp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_vector.html">Vector</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds a vector with the origin as the start point.  <a href="struct_vector.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_angles.html">Angles</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure for holding the association angles of a bimolecular reaction.  <a href="struct_angles.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga86c49c9be828e891029ab83e72bc3ef1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#ga86c49c9be828e891029ab83e72bc3ef1">associate</a> (int ifaceIndex1, int ifaceIndex2, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol1, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol2, <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom1, <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom2, const <a class="el" href="struct_parameters.html">Parameters</a> &amp;params, const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;currRxn, std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;moleculeList, std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;molTemplateList, std::vector&lt; int &gt; &amp;emptyMolList, std::vector&lt; int &gt; &amp;emptyComList, std::map&lt; std::string, int &gt; &amp;observablesList)</td></tr>
<tr class="memdesc:ga86c49c9be828e891029ab83e72bc3ef1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main association function, which puts the two complexes at sigma and then performs the rotations.  <a href="#ga86c49c9be828e891029ab83e72bc3ef1">More...</a><br /></td></tr>
<tr class="separator:ga86c49c9be828e891029ab83e72bc3ef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9cf0e1e647c1523e6e51ebf1f6b3343b"><td class="memItemLeft" align="right" valign="top"><a id="ga9cf0e1e647c1523e6e51ebf1f6b3343b"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#ga9cf0e1e647c1523e6e51ebf1f6b3343b">areSameAngle</a> (double ang1, double ang2)</td></tr>
<tr class="memdesc:ga9cf0e1e647c1523e6e51ebf1f6b3343b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This checks if two angles are equal, accounting for minus signs. <br /></td></tr>
<tr class="separator:ga9cf0e1e647c1523e6e51ebf1f6b3343b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac9f5d023458e6670d5236734370dafb8"><td class="memItemLeft" align="right" valign="top"><a id="gac9f5d023458e6670d5236734370dafb8"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#gac9f5d023458e6670d5236734370dafb8">areParallel</a> (const double &amp;angle)</td></tr>
<tr class="memdesc:gac9f5d023458e6670d5236734370dafb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if two vectors are parallel. <br /></td></tr>
<tr class="separator:gac9f5d023458e6670d5236734370dafb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82ae8ea92849fa5c02cba0e143428a9e"><td class="memItemLeft" align="right" valign="top"><a id="ga82ae8ea92849fa5c02cba0e143428a9e"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#ga82ae8ea92849fa5c02cba0e143428a9e">angleSignIsCorrect</a> (const <a class="el" href="struct_vector.html">Vector</a> &amp;vec1, const <a class="el" href="struct_vector.html">Vector</a> &amp;vec2)</td></tr>
<tr class="memdesc:ga82ae8ea92849fa5c02cba0e143428a9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the sign of the angle is the correct sign demanded by the desired angle. <br /></td></tr>
<tr class="separator:ga82ae8ea92849fa5c02cba0e143428a9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacc5e1e4f35d3534e9ed78cece57ae560"><td class="memItemLeft" align="right" valign="top"><a id="gacc5e1e4f35d3534e9ed78cece57ae560"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#gacc5e1e4f35d3534e9ed78cece57ae560">requiresSignFlip</a> (<a class="el" href="struct_vector.html">Vector</a> axis, <a class="el" href="struct_vector.html">Vector</a> v1, <a class="el" href="struct_vector.html">Vector</a> v2)</td></tr>
<tr class="memdesc:gacc5e1e4f35d3534e9ed78cece57ae560"><td class="mdescLeft">&#160;</td><td class="mdescRight">A generic version of dihedral_projection and phi_projection, to project any arbitray axes onto a plane TODO: Rename this. <br /></td></tr>
<tr class="separator:gacc5e1e4f35d3534e9ed78cece57ae560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0680179982e96f5b10fd2501c495ae1a"><td class="memItemLeft" align="right" valign="top"><a id="ga0680179982e96f5b10fd2501c495ae1a"></a>
<a class="el" href="struct_vector.html">Vector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#ga0680179982e96f5b10fd2501c495ae1a">create_arbitrary_vector</a> (<a class="el" href="struct_vector.html">Vector</a> &amp;vec)</td></tr>
<tr class="memdesc:ga0680179982e96f5b10fd2501c495ae1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an arbitrary vector orthogonal another vector, base on the cross product of it and either the x or y axis. <br /></td></tr>
<tr class="separator:ga0680179982e96f5b10fd2501c495ae1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafbbbb326f84c2586a9b5026688dbd7b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#gafbbbb326f84c2586a9b5026688dbd7b9">transform</a> (const bool isOnMembrane, <a class="el" href="struct_coord.html">Coord</a> &amp;reactIface, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol1, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol2, const <a class="el" href="struct_vector.html">Vector</a> &amp;axis)</td></tr>
<tr class="memdesc:gafbbbb326f84c2586a9b5026688dbd7b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms a molecule's interface and center of coordinates, used only by projection functions (project(), project_omega(), project_phi()).  <a href="#gafbbbb326f84c2586a9b5026688dbd7b9">More...</a><br /></td></tr>
<tr class="separator:gafbbbb326f84c2586a9b5026688dbd7b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab33d85f4287d696e704c2e2bf807ec83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#gab33d85f4287d696e704c2e2bf807ec83">determine_rotation_angles</a> (double targAngle, double currAngle, double &amp;rotAngPos, double &amp;rotAngNeg, const <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom1, const <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom2)</td></tr>
<tr class="memdesc:gab33d85f4287d696e704c2e2bf807ec83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the rotation angles for each <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a>, according to their diffusion constants.  <a href="#gab33d85f4287d696e704c2e2bf807ec83">More...</a><br /></td></tr>
<tr class="separator:gab33d85f4287d696e704c2e2bf807ec83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1745613a8a2b9aab86bbc4150f3c66f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_quat.html">Quat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#ga1745613a8a2b9aab86bbc4150f3c66f6">orient_crds_to_template</a> (const <a class="el" href="struct_mol_template.html">MolTemplate</a> &amp;oneTemplate, <a class="el" href="struct_molecule.html">Molecule</a> &amp;targMol)</td></tr>
<tr class="memdesc:ga1745613a8a2b9aab86bbc4150f3c66f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is meant to determine a quaternion for the rotation of the target <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> to its <a class="el" href="struct_mol_template.html" title="Data structure for holding the molecule types.">MolTemplate</a> coordinates, based on the interface to center of mass vectors of the <a class="el" href="struct_mol_template.html" title="Data structure for holding the molecule types.">MolTemplate</a>.  <a href="#ga1745613a8a2b9aab86bbc4150f3c66f6">More...</a><br /></td></tr>
<tr class="separator:ga1745613a8a2b9aab86bbc4150f3c66f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f412ee5d4654de71fed4f4b0b459d5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#ga4f412ee5d4654de71fed4f4b0b459d5c">rotate</a> (<a class="el" href="struct_coord.html">Coord</a> &amp;rotOrigin, <a class="el" href="struct_quat.html">Quat</a> &amp;rotQuat, <a class="el" href="struct_complex.html">Complex</a> &amp;targCom, std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;moleculeList)</td></tr>
<tr class="memdesc:ga4f412ee5d4654de71fed4f4b0b459d5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is meant to rotate a target <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a> with a rotation quaternion determined from the associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a>, and then translate it to a specific position.  <a href="#ga4f412ee5d4654de71fed4f4b0b459d5c">More...</a><br /></td></tr>
<tr class="separator:ga4f412ee5d4654de71fed4f4b0b459d5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada39990258c9c5a7147db2026b59680c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#gada39990258c9c5a7147db2026b59680c">reverse_rotation</a> (<a class="el" href="struct_coord.html">Coord</a> &amp;reactIface1, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol1, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol2, <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom1, <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom2, <a class="el" href="struct_quat.html">Quat</a> rotQuatPos, <a class="el" href="struct_quat.html">Quat</a> rotQuatNeg, std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;moleculeList)</td></tr>
<tr class="memdesc:gada39990258c9c5a7147db2026b59680c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is meant to rotate a <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> in the reverse direction.  <a href="#gada39990258c9c5a7147db2026b59680c">More...</a><br /></td></tr>
<tr class="separator:gada39990258c9c5a7147db2026b59680c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga21d14b801303107a1f7f13d0e53b6149"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#ga21d14b801303107a1f7f13d0e53b6149">theta_rotation</a> (<a class="el" href="struct_coord.html">Coord</a> &amp;reactIface1, <a class="el" href="struct_coord.html">Coord</a> &amp;reactIface2, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol1, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol2, double targAngle, const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;currRxn, <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom1, <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom2, std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;moleculeList)</td></tr>
<tr class="memdesc:ga21d14b801303107a1f7f13d0e53b6149"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to rotate a <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> to some a target angle theta, relative to sigma (the angle between the two associating interfaces).  <a href="#ga21d14b801303107a1f7f13d0e53b6149">More...</a><br /></td></tr>
<tr class="separator:ga21d14b801303107a1f7f13d0e53b6149"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac454cddf9265c08bd5bbbf6bc5fd97c8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#gac454cddf9265c08bd5bbbf6bc5fd97c8">phi_rotation</a> (<a class="el" href="struct_coord.html">Coord</a> &amp;reactIface1, <a class="el" href="struct_coord.html">Coord</a> &amp;reactIface2, int ifaceIndex2, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol1, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol2, <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom1, <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom2, const <a class="el" href="struct_vector.html">Vector</a> &amp;normal, const double &amp;targPhi, const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;currRxn, std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;moleculeList, const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;molTemplateList)</td></tr>
<tr class="memdesc:gac454cddf9265c08bd5bbbf6bc5fd97c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to rotate a <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> to some a target dihedral phi, relative to sigma (the (sigma)-(interface)-(normal) dihedral)  <a href="#gac454cddf9265c08bd5bbbf6bc5fd97c8">More...</a><br /></td></tr>
<tr class="separator:gac454cddf9265c08bd5bbbf6bc5fd97c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga24f4620ba38e36f9e92c575eb3b6ff21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#ga24f4620ba38e36f9e92c575eb3b6ff21">omega_rotation</a> (<a class="el" href="struct_coord.html">Coord</a> &amp;reactIface1, <a class="el" href="struct_coord.html">Coord</a> &amp;reactIface2, int ifaceIndex2, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol1, <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol2, <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom1, <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom2, double targOmega, const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;currRxn, std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;moleculeList, const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;molTemplateList)</td></tr>
<tr class="memdesc:ga24f4620ba38e36f9e92c575eb3b6ff21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a rotation of two molecules to some target omega angle, the com-iface1 to sigma to com-iface2 dihedral angle.  <a href="#ga24f4620ba38e36f9e92c575eb3b6ff21">More...</a><br /></td></tr>
<tr class="separator:ga24f4620ba38e36f9e92c575eb3b6ff21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga64d76311835582d13bffd3c51f1549fe"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#ga64d76311835582d13bffd3c51f1549fe">calculate_omega</a> (const bool isOnMembrane, <a class="el" href="struct_coord.html">Coord</a> reactIface1, int reactIface2, <a class="el" href="struct_vector.html">Vector</a> &amp;sigma, const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;currRxn, <a class="el" href="struct_molecule.html">Molecule</a> reactMol1, <a class="el" href="struct_molecule.html">Molecule</a> reactMol2, const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;molTemplateList)</td></tr>
<tr class="memdesc:ga64d76311835582d13bffd3c51f1549fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">this should get omega via an orthographic projected onto the xy-plane. why? because if the com-iface/norm vectors are not parallel, i.e. if theta1, theta2 != M_PI the code gets confused  <a href="#ga64d76311835582d13bffd3c51f1549fe">More...</a><br /></td></tr>
<tr class="separator:ga64d76311835582d13bffd3c51f1549fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f1c220d5c6d8196468a5997872f04f0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#ga6f1c220d5c6d8196468a5997872f04f0">calculate_phi</a> (<a class="el" href="struct_coord.html">Coord</a> reactIface1, int ifaceIndex2, <a class="el" href="struct_molecule.html">Molecule</a> reactMol1, <a class="el" href="struct_molecule.html">Molecule</a> reactMol2, const <a class="el" href="struct_vector.html">Vector</a> &amp;normal, <a class="el" href="struct_vector.html">Vector</a> axis, const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;currRxn, const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;molTemplateList)</td></tr>
<tr class="memdesc:ga6f1c220d5c6d8196468a5997872f04f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">this should get phi via an orthographic projected onto the xy-plane.  <a href="#ga6f1c220d5c6d8196468a5997872f04f0">More...</a><br /></td></tr>
<tr class="separator:ga6f1c220d5c6d8196468a5997872f04f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga11293a8cda0a40f473466b6c9022e977"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#ga11293a8cda0a40f473466b6c9022e977">check_bases</a> (bool &amp;cancelAssoc, const <a class="el" href="struct_coord.html">Coord</a> &amp;reactIface1, const <a class="el" href="struct_coord.html">Coord</a> &amp;reactIface2, int ifaceIndex1, int ifaceIndex2, const <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol1, const <a class="el" href="struct_molecule.html">Molecule</a> &amp;reactMol2, const <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom1, const <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom2, const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;currRxn, const std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;moleculeList, const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;molTemplateList)</td></tr>
<tr class="memdesc:ga11293a8cda0a40f473466b6c9022e977"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks to make sure association was successful.  <a href="#ga11293a8cda0a40f473466b6c9022e977">More...</a><br /></td></tr>
<tr class="separator:ga11293a8cda0a40f473466b6c9022e977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade0b700e1090fcd94347f217d0da053c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___associate.html#gade0b700e1090fcd94347f217d0da053c">check_for_structure_overlap</a> (bool &amp;cancelAssoc, const <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom1, const <a class="el" href="struct_complex.html">Complex</a> &amp;reactCom2, const std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;moleculeList, const <a class="el" href="struct_parameters.html">Parameters</a> &amp;params, const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;molTemplateList)</td></tr>
<tr class="memdesc:gade0b700e1090fcd94347f217d0da053c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks to see if the centers of masses of the molecules overlap.  <a href="#gade0b700e1090fcd94347f217d0da053c">More...</a><br /></td></tr>
<tr class="separator:gade0b700e1090fcd94347f217d0da053c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions specifically used for the association of two molecules. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga86c49c9be828e891029ab83e72bc3ef1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga86c49c9be828e891029ab83e72bc3ef1">&#9670;&nbsp;</a></span>associate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void associate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifaceIndex1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifaceIndex2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_parameters.html">Parameters</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;&#160;</td>
          <td class="paramname"><em>currRxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>moleculeList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>molTemplateList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>emptyMolList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>emptyComList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, int &gt; &amp;&#160;</td>
          <td class="paramname"><em>observablesList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main association function, which puts the two complexes at sigma and then performs the rotations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ifaceIndex1</td><td>Index of first reactant interface in reactMol1.interfaceList. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ifaceIndex2</td><td>Index of second reactant interface in reactMol2.interfaceList. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol1</td><td><a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> object for the parent <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> of the first reacting interface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol2</td><td><a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> object for the parent <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> of the second reacting interface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactCom1</td><td>Parent <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a> object for reactMol1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactCom2</td><td>Parent <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a> object for reactMol2</td></tr>
  </table>
  </dd>
</dl>
<p>Delegates to <a class="el" href="group___associate.html#ga21d14b801303107a1f7f13d0e53b6149" title="Function to rotate a Molecule to some a target angle theta, relative to sigma (the angle between the ...">theta_rotation()</a>, <a class="el" href="group___associate.html#gac454cddf9265c08bd5bbbf6bc5fd97c8" title="Function to rotate a Molecule to some a target dihedral phi, relative to sigma (the (sigma)-(interfac...">phi_rotation()</a>, and <a class="el" href="group___associate.html#ga24f4620ba38e36f9e92c575eb3b6ff21" title="Performs a rotation of two molecules to some target omega angle, the com-iface1 to sigma to com-iface...">omega_rotation()</a> to do the actual rotations themselves</p>
<h3>MAP</h3>
<ol type="1">
<li>Set up temporary association coordinates</li>
<li>Translate the reacting interfaces such that they overlap</li>
<li>Translate the reacting interfaces to sigma along the center of mass to center of mass vector</li>
<li>Rotate theta, starting with theta_2</li>
<li>Rotate phi, starting with phi_2</li>
<li>Rotate omega</li>
<li>Check angles, vector magnitudes to make sure everything worked properly </li>
</ol>

</div>
</div>
<a id="ga64d76311835582d13bffd3c51f1549fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga64d76311835582d13bffd3c51f1549fe">&#9670;&nbsp;</a></span>calculate_omega()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calculate_omega </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>isOnMembrane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_coord.html">Coord</a>&#160;</td>
          <td class="paramname"><em>reactIface1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reactIface2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;&#160;</td>
          <td class="paramname"><em>currRxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a>&#160;</td>
          <td class="paramname"><em>reactMol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a>&#160;</td>
          <td class="paramname"><em>reactMol2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>molTemplateList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this should get omega via an orthographic projected onto the xy-plane. why? because if the com-iface/norm vectors are not parallel, i.e. if theta1, theta2 != M_PI the code gets confused </p>
<ol type="1">
<li>rotate the two proteins such that sigma is on the z axis</li>
<li>do orthographic projection onto the xy-plane.</li>
<li>determine omega between the com-iface, or the norm vectors, if one of the theta angles is M_PI</li>
<li>return omega. </li>
</ol>

</div>
</div>
<a id="ga6f1c220d5c6d8196468a5997872f04f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6f1c220d5c6d8196468a5997872f04f0">&#9670;&nbsp;</a></span>calculate_phi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calculate_phi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_coord.html">Coord</a>&#160;</td>
          <td class="paramname"><em>reactIface1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifaceIndex2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a>&#160;</td>
          <td class="paramname"><em>reactMol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a>&#160;</td>
          <td class="paramname"><em>reactMol2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_vector.html">Vector</a>&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;&#160;</td>
          <td class="paramname"><em>currRxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>molTemplateList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this should get phi via an orthographic projected onto the xy-plane. </p>
<ol type="1">
<li>first rotation the two proteins such the com-iface vector is on the z axis</li>
<li>do orthographic projection onto the xy-plane.</li>
<li>determine phi between sigma and norm.</li>
<li>return phi. </li>
</ol>

</div>
</div>
<a id="ga11293a8cda0a40f473466b6c9022e977"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga11293a8cda0a40f473466b6c9022e977">&#9670;&nbsp;</a></span>check_bases()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_bases </td>
          <td>(</td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>cancelAssoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_coord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>reactIface1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_coord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>reactIface2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifaceIndex1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifaceIndex2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;&#160;</td>
          <td class="paramname"><em>currRxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>moleculeList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>molTemplateList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks to make sure association was successful. </p>
<p>Checks if</p><ol type="1">
<li>all angles are at their desired value</li>
<li>magnitude of the interface-center of mass vectors was conserved</li>
<li>the rigitidy of the molecules was conserved </li>
</ol>

</div>
</div>
<a id="gade0b700e1090fcd94347f217d0da053c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gade0b700e1090fcd94347f217d0da053c">&#9670;&nbsp;</a></span>check_for_structure_overlap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_for_structure_overlap </td>
          <td>(</td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>cancelAssoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>moleculeList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_parameters.html">Parameters</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>molTemplateList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks to see if the centers of masses of the molecules overlap. </p>
<p>If so, cancels association. </p>

</div>
</div>
<a id="gab33d85f4287d696e704c2e2bf807ec83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab33d85f4287d696e704c2e2bf807ec83">&#9670;&nbsp;</a></span>determine_rotation_angles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void determine_rotation_angles </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>targAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>currAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>rotAngPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>rotAngNeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the rotation angles for each <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a>, according to their diffusion constants. </p>
<p>If both complexes have no rotational diffusion (i.e. both complexes are on the membrane), it uses translational diffusion constants, in either the x- or z-component, depending on if either are larger than zero. </p>

</div>
</div>
<a id="ga24f4620ba38e36f9e92c575eb3b6ff21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga24f4620ba38e36f9e92c575eb3b6ff21">&#9670;&nbsp;</a></span>omega_rotation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void omega_rotation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_coord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>reactIface1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_coord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>reactIface2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifaceIndex2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>targOmega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;&#160;</td>
          <td class="paramname"><em>currRxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>moleculeList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>molTemplateList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a rotation of two molecules to some target omega angle, the com-iface1 to sigma to com-iface2 dihedral angle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">reactIface1</td><td>first reactant interface (order is arbitrary) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactIface2</td><td>second reactant interface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol1</td><td>first reactant molecule </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol2</td><td>second reactant molecule </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactCom1</td><td>parent complex of first reactant molecule </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactCom2</td><td>parent complex of second reactant molecule </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">currRxn</td><td>current association reaction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">moleculeList</td><td>list of all Molecules in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">molTemplateList</td><td>list of all MolTemplates </td></tr>
  </table>
  </dd>
</dl>
<p>Performs a rotation of two molecules to some target omega angle, the com-iface1 to sigma to com-iface2 dihedral angle</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">reactIface1</td><td>first reactant interface (order is arbitrary) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactIface2</td><td>second reactant interface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol1</td><td>first reactant molecule </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol2</td><td>second reactant molecule </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactCom1</td><td>parent complex of first reactant molecule </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactCom2</td><td>parent complex of second reactant molecule </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">currRxn</td><td>current association reaction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">moleculeList</td><td>list of all Molecules in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">molTemplateList</td><td>list of all MolTemplates</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1745613a8a2b9aab86bbc4150f3c66f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1745613a8a2b9aab86bbc4150f3c66f6">&#9670;&nbsp;</a></span>orient_crds_to_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_quat.html">Quat</a> orient_crds_to_template </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_mol_template.html">MolTemplate</a> &amp;&#160;</td>
          <td class="paramname"><em>oneTemplate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>targMol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is meant to determine a quaternion for the rotation of the target <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> to its <a class="el" href="struct_mol_template.html" title="Data structure for holding the molecule types.">MolTemplate</a> coordinates, based on the interface to center of mass vectors of the <a class="el" href="struct_mol_template.html" title="Data structure for holding the molecule types.">MolTemplate</a>. </p>
<p>If the <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> is not a rod, two interfaces to center of mass vectors are used to determine the quaternion. TODO: Write how/why </p>

</div>
</div>
<a id="gac454cddf9265c08bd5bbbf6bc5fd97c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac454cddf9265c08bd5bbbf6bc5fd97c8">&#9670;&nbsp;</a></span>phi_rotation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phi_rotation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_coord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>reactIface1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_coord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>reactIface2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifaceIndex2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>targPhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;&#160;</td>
          <td class="paramname"><em>currRxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>moleculeList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="struct_mol_template.html">MolTemplate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>molTemplateList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to rotate a <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> to some a target dihedral phi, relative to sigma (the (sigma)-(interface)-(normal) dihedral) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">reactIface1</td><td>The associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> <a class="el" href="struct_interface.html" title="Contains information of a MolTemplate&#39;s interfaces.">Interface</a> of domMol </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactIface2</td><td>The associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> <a class="el" href="struct_interface.html" title="Contains information of a MolTemplate&#39;s interfaces.">Interface</a> of infMol </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol1</td><td>The associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> which we are rotating to the target theta angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol2</td><td>The other associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targAngle</td><td>Target theta angle between the two Molecules. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">currRxn</td><td>Foward reaction (<a class="el" href="struct_forward_rxn.html" title="Holds information on one forward reaction.">ForwardRxn</a>) currently being performed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactCom1</td><td>The parent <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a> of the associating dominant <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> (the <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> currently being rotated) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactCom2</td><td>The parent <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a> of the associating inferior <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> (the other <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> in the reaction) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">moleculeList</td><td>List of all molecules in the system.</td></tr>
  </table>
  </dd>
</dl>
<h3>MAP</h3>
<ol type="1">
<li>Calculate current phi using <a class="el" href="group___associate.html#ga6f1c220d5c6d8196468a5997872f04f0" title="this should get phi via an orthographic projected onto the xy-plane.">calculate_phi()</a>. See for details.</li>
<li>If current phi is not the target angle, within tolerance, rotation is needed.</li>
<li>Determine how far to rotate each protein according to their respective diffusion constants</li>
<li>Determine rotation quaternions using positive rotation for dominant protein and negative for inferior</li>
<li>Rotate.</li>
<li>If rotated phi is incorrect, reverse rotation and rotate in the opposite direction (negative for dominant positive for inferior)</li>
</ol>
<p>Why the index of the inferior interface?</p>
<p>The index of infIface is needed because domIface and infIface are references to references to (yes, references to references) their respective coordinates in their respective <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a>'s assocICoords vector. Since domIface, infIface, domMol, and infMol are passed by value to <a class="el" href="group___associate.html#ga6f1c220d5c6d8196468a5997872f04f0" title="this should get phi via an orthographic projected onto the xy-plane.">calculate_phi()</a>, and through it also to <a class="el" href="group___associate.html#gafbbbb326f84c2586a9b5026688dbd7b9" title="Transforms a molecule&#39;s interface and center of coordinates, used only by projection functions (proje...">transform()</a>. The <a class="el" href="group___associate.html#gafbbbb326f84c2586a9b5026688dbd7b9" title="Transforms a molecule&#39;s interface and center of coordinates, used only by projection functions (proje...">transform()</a> function does a coordinate transformation which changes the domMol and infMol coordinates but does not change domIface or infIface, since they are references to different objects. Because of this, the creation of the projected vectors in <a class="el" href="group___associate.html#ga6f1c220d5c6d8196468a5997872f04f0" title="this should get phi via an orthographic projected onto the xy-plane.">calculate_phi()</a> will fail unless the index of infIface is passed to it. </p>
<p>Function to rotate a <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> to some a target dihedral phi, relative to sigma (the (sigma)-(interface)-(normal) dihedral)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iface1</td><td>associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> <a class="el" href="struct_interface.html" title="Contains information of a MolTemplate&#39;s interfaces.">Interface</a> of mol1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iface2</td><td>associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> <a class="el" href="struct_interface.html" title="Contains information of a MolTemplate&#39;s interfaces.">Interface</a> of mol2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ifaceIndex2</td><td>the index of iface2 in mol2.assocICoords (see below for why) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mol1</td><td>associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> which we are rotating to the target theta angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mol2</td><td>the other associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targAngle</td><td>target theta angle</td></tr>
  </table>
  </dd>
</dl>
<h3>MAP</h3>
<ol type="1">
<li>Calculate current phi using <a class="el" href="group___associate.html#ga6f1c220d5c6d8196468a5997872f04f0" title="this should get phi via an orthographic projected onto the xy-plane.">calculate_phi()</a>. See for details.</li>
<li>If current phi is not the target angle, within tolerance, rotation is needed.</li>
<li>Determine how far to rotate each protein according to their respective diffusion constants</li>
<li>Determine rotation quaternions using positive rotation for ldrinant protein and negative for fferior</li>
<li>Rotate.</li>
<li>If rotated phi is incorrect, reverse rotation and rotate in the opposite direction (negative for ldrinant positive for fferior)</li>
</ol>
<p>Why the index of the fferior interface?</p>
<p>The index of iface2 is needed because iface1 and iface2 are references to references to (yes, references to references) their respective coordinates in their respective <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a>'s assocICoords vector. Since iface1, iface2, mol1, and mol2 are passed by value to <a class="el" href="group___associate.html#ga6f1c220d5c6d8196468a5997872f04f0" title="this should get phi via an orthographic projected onto the xy-plane.">calculate_phi()</a>, and through it also to <a class="el" href="group___associate.html#gafbbbb326f84c2586a9b5026688dbd7b9" title="Transforms a molecule&#39;s interface and center of coordinates, used only by projection functions (proje...">transform()</a>. The <a class="el" href="group___associate.html#gafbbbb326f84c2586a9b5026688dbd7b9" title="Transforms a molecule&#39;s interface and center of coordinates, used only by projection functions (proje...">transform()</a> function does a coordinate transformation which changes the mol1 and mol2 coordinates but does not change iface1 or iface2, since they are references to different objects. Because of this, the creation of the projected vectors in <a class="el" href="group___associate.html#ga6f1c220d5c6d8196468a5997872f04f0" title="this should get phi via an orthographic projected onto the xy-plane.">calculate_phi()</a> will fail unless the index of iface2 is passed to it.</p>

</div>
</div>
<a id="gada39990258c9c5a7147db2026b59680c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada39990258c9c5a7147db2026b59680c">&#9670;&nbsp;</a></span>reverse_rotation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reverse_rotation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_coord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>reactIface1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_quat.html">Quat</a>&#160;</td>
          <td class="paramname"><em>rotQuatPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_quat.html">Quat</a>&#160;</td>
          <td class="paramname"><em>rotQuatNeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>moleculeList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is meant to rotate a <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> in the reverse direction. </p>
<ul>
<li>It does so by determining the inverse of the two quaterions (from the half angles), and rotating with these new quaternions.</li>
<li><img class="formulaInl" alt="$ Q^{-1} (Q(vec)Q^{-1})Q $" src="form_22.png"/> </li>
</ul>

</div>
</div>
<a id="ga4f412ee5d4654de71fed4f4b0b459d5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4f412ee5d4654de71fed4f4b0b459d5c">&#9670;&nbsp;</a></span>rotate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_coord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>rotOrigin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_quat.html">Quat</a> &amp;&#160;</td>
          <td class="paramname"><em>rotQuat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>targCom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>moleculeList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is meant to rotate a target <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a> with a rotation quaternion determined from the associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a>, and then translate it to a specific position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rotOrigin</td><td>The origin for all vectors to rotate around. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQuat</td><td>Rotation Quaternion determined in the angle-relevant rotation function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targCom</td><td>The complex being rotated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">moleculeList</td><td>List of all Molecules in the system.</td></tr>
  </table>
  </dd>
</dl>
<p>TODO: Write how </p>

</div>
</div>
<a id="ga21d14b801303107a1f7f13d0e53b6149"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga21d14b801303107a1f7f13d0e53b6149">&#9670;&nbsp;</a></span>theta_rotation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void theta_rotation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_coord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>reactIface1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_coord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>reactIface2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>targAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_forward_rxn.html">ForwardRxn</a> &amp;&#160;</td>
          <td class="paramname"><em>currRxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_complex.html">Complex</a> &amp;&#160;</td>
          <td class="paramname"><em>reactCom2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="struct_molecule.html">Molecule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>moleculeList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to rotate a <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> to some a target angle theta, relative to sigma (the angle between the two associating interfaces). </p>
<p><a class="el" href="struct_forward_rxn.html" title="Holds information on one forward reaction.">ForwardRxn</a>&amp; rxn, <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a>&amp; domCom, <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a>&amp; infCom, std::vector&lt;Molecule&gt;&amp; molList) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">reactIface1</td><td>The associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> <a class="el" href="struct_interface.html" title="Contains information of a MolTemplate&#39;s interfaces.">Interface</a> of domMol </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactIface2</td><td>The associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> <a class="el" href="struct_interface.html" title="Contains information of a MolTemplate&#39;s interfaces.">Interface</a> of infMol </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol1</td><td>The associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> which we are rotating to the target theta angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol2</td><td>The other associating <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targAngle</td><td>Target theta angle between the two Molecules. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">currRxn</td><td>Foward reaction (<a class="el" href="struct_forward_rxn.html" title="Holds information on one forward reaction.">ForwardRxn</a>) currently being performed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactCom1</td><td>The parent <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a> of the associating dominant <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> (the <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> currently being rotated) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactCom2</td><td>The parent <a class="el" href="struct_complex.html" title="Contains information on each complex, i.e. bound Molecules.">Complex</a> of the associating inferior <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> (the other <a class="el" href="struct_molecule.html" title="Contains information for one specie (protein, lipid, etc.) in the system.">Molecule</a> in the reaction) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">moleculeList</td><td>List of all molecules in the system.</td></tr>
  </table>
  </dd>
</dl>
<h3>MAP</h3>
<ol type="1">
<li>Calculate current theta by taking the dot product of the interface to center of mass vector and sigma: <img class="formulaInl" alt="$ \theta = acos((com-iface) \cdot \sigma) $" src="form_31.png"/></li>
<li>If the current theta is not equal to the target theta, within a tolerance, rotation is needed.</li>
<li>Determine the axis of rotation<ul>
<li>If the target angle is either <img class="formulaInl" alt="$\pi$" src="form_1.png"/> or 0, we can't use the cross product of the (com)-(iface) and <img class="formulaInl" alt="$\sigma$" src="form_32.png"/> as the axis of rotation, so we use the one of the cartesian coordinate axes.</li>
</ul>
</li>
<li>Get quaternions for the rotation<ul>
<li>Positive rotation for the dominant protein and negative rotation for the inferior protein.</li>
<li>Based on each complex's diffusion constants</li>
</ul>
</li>
<li>Rotate</li>
<li>Check rotation, if incorrect, reverse rotation and rotate the other way (i.e. negative rotation for dominant and positive for inferior).<ul>
<li>This is a safeguard, and it's not often needed. Probably due to missing a sign check somewhere.</li>
</ul>
</li>
</ol>
<p>### Uses quaternion rotation:</p><ul>
<li><img class="formulaInl" alt="$Q (vec) Q^{-1}$" src="form_17.png"/> --&gt; rotation of vector using quaternion <img class="formulaInl" alt="$Q$" src="form_12.png"/>. <img class="formulaInl" alt="$Q^{-1}$" src="form_18.png"/> is the inverse of <img class="formulaInl" alt="$Q$" src="form_12.png"/>, <img class="formulaInl" alt="$Q = (C, w)$" src="form_19.png"/> where C is the rotation angle and w is the axis of rotation <img class="formulaInl" alt="$(ai + bj + ck)$" src="form_23.png"/>.</li>
<li>Q must be normalized for rotation. Normalizes entire thing, including C</li>
<li>For rotation we use half angles (ang/2), <img class="formulaInl" alt="$Q = (sin(ang/2), cos(ang/2) * w.x, cos(ang/2) * w.y, cos(ang/2) * w.z)$" src="form_24.png"/> </li>
</ul>

</div>
</div>
<a id="gafbbbb326f84c2586a9b5026688dbd7b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafbbbb326f84c2586a9b5026688dbd7b9">&#9670;&nbsp;</a></span>transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transform </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>isOnMembrane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_coord.html">Coord</a> &amp;&#160;</td>
          <td class="paramname"><em>reactIface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>reactMol2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transforms a molecule's interface and center of coordinates, used only by projection functions (project(), project_omega(), project_phi()). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">reactIface</td><td>reacting interface of the current molecule being rotated and transformed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol1</td><td>current molecule being rotated and transformed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reactMol2</td><td>other molecule in the association event </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axis</td><td>axis around which the molecules are rotating</td></tr>
  </table>
  </dd>
</dl>
<p>NOTE: Only use this function if the calling function is passed reactMol1 and reactMol2 by value, NOT by reference. This function alters the coordinates in a way that is not desired by association, but required in the course of it. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
