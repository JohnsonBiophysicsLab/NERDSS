<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NERDSS: Association Algorithm</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NERDSS
   &#160;<span id="projectnumber">0.90</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Association Algorithm </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#algo">Algorithm</a></li>
<li class="level1"><a href="#angles">Angles</a><ul><li class="level2"><a href="#theta">Theta</a></li>
<li class="level2"><a href="#phi">Phi</a></li>
<li class="level2"><a href="#omega">Omega</a></li>
<li class="level2"><a href="#homo">Homogenous Association</a></li>
<li class="level2"><a href="#hetero">Heterogenous Association</a></li>
</ul>
</li>
<li class="level1"><a href="#Math">Math</a><ul><li class="level2"><a href="#Quaternions">Quaternions</a><ul><li class="level3"><a href="#intro">Introduction</a></li>
<li class="level3"><a href="#why">Why Quaternions?</a></li>
<li class="level3"><a href="#rotation">Rotations with Quaternions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>A description of the algorithm used when a binding event between two molecules occurs.</p>
<ul>
<li>See <a class="el" href="group___associate.html">Associate</a> for relevant classes</li>
</ul>
<h1><a class="anchor" id="algo"></a>
Algorithm</h1>
<ul>
<li>See <a href="angle_documentation.pdf"><b>here</b></a> for a more complete (math-ey) description of the rotations.</li>
<li>Five angles are used to constrain the molecules into their bound conformation (see below)</li>
<li>Note that all translations/rotations are done proportional to each complex's total diffusion constants, i.e. a complex which a diffusion constant twice that of the other will move twice as far.</li>
</ul>
<ol type="1">
<li>The two reacting interfaces are placed at contact by translation along the vector between them.</li>
<li>The complexes are pushed apart to sigma by translation along the interface-interface vector</li>
<li><img class="formulaInl" alt="$\theta$" src="form_0.png"/> rotations are performed, by determining the difference between the current and desired <img class="formulaInl" alt="$\theta$" src="form_0.png"/> angles and determining a rotation quaternion based on that difference and the rotation axis vector, the cross product between the (center of mass)-(reacting interface) and sigma vectors. <img class="formulaInl" alt="$\theta_2$" src="form_2.png"/> is corrected first, with <img class="formulaInl" alt="$\theta_1$" src="form_3.png"/> following.</li>
<li>Next, the omega angle is corrected, using sigma as the axis of rotation.<ol type="a">
<li>Determine the current omega angle:<ul>
<li>The two (center of mass)-(reacting interface) vectors are projected onto a plane looking down the rotation axis (an orthographic projection)</li>
<li>The sign of the angle between them is determined by taking the cross product and looking at the sign of the z value (either pointing towards the camera or away from it)</li>
</ul>
</li>
<li>Determine the two rotation quaternions for the reactants (positive and negative rotations, based on their contributions to the total diffusion constant)</li>
<li>Rotate and translate.</li>
</ol>
</li>
<li>Phi rotations are performed, using the (center of mass)-(reacting interface) as the axes of rotation.</li>
</ol>
<ul>
<li>All rotations are performed using the reacting interface as the origin, e.g. for theta 2, reactant 2 is the dominant interface, and rotations are done using the vector between it and whatever interface or center of mass is being rotated.</li>
<li>For all three rotation methods, if the first rotation fails to produce the desired angle, the rotation is reversed and the centers of mass and interfaces are returned to their original positions. The positive and negative half angles are then swapped and the rotation is performed with those new angles (i.e. the rotation is reversed in direction from the original). If this still produces the wrong angle, the association is cancelled.</li>
</ul>
<div class="image">
<img src="algo_flowchart_horiz.pdf" alt="algo_flowchart_horiz.pdf"/>
</div>
<hr/>
<h1><a class="anchor" id="angles"></a>
Angles</h1>
<ul>
<li>Five angles are used to orient the two associating molecules, <img class="formulaInl" alt="$ \theta_1,~\theta_2,~\phi_1,~\phi_2,~\omega $" src="form_4.png"/></li>
<li>Using a toy model of two proteins interaction (red and blue) through an interface (iface1 and iface2), the below show the angles in practice.</li>
</ul>
<div class="image">
<img src="docs/associate_figs/angles/assoc_before.pdf" alt="assoc_before.pdf"/>
</div>
<h2><a class="anchor" id="theta"></a>
Theta</h2>
<ul>
<li>Angle between the (center of mass)-(reacting interface) and the <img class="formulaInl" alt="$ \sigma $" src="form_25.png"/> vectors. Each association reaction has two <img class="formulaInl" alt="$ \theta $" src="form_26.png"/> angles.</li>
</ul>
<div class="image">
<img src="docs/associate_figs/angles/theta.pdf" alt="theta.pdf"/>
</div>
<h2><a class="anchor" id="phi"></a>
Phi</h2>
<ul>
<li>Dihedral between an arbitrary (by default the z-axis, or x- or y-axis if an interface to center of mass vector lies along it), center of mass to interface, and sigma vectors for each protein. Each association reaction has two <img class="formulaInl" alt="$ \phi $" src="form_27.png"/> angles.</li>
</ul>
<div class="image">
<img src="docs/associate_figs/angles/phi.pdf" alt="phi.pdf"/>
</div>
<h2><a class="anchor" id="omega"></a>
Omega</h2>
<ul>
<li>Dihedral between protein 1's center of mass to interface vector, the <img class="formulaInl" alt="$ \sigma $" src="form_25.png"/> vector, and protein 2's center of mass to interface vector. Each association reaction has one <img class="formulaInl" alt="$ \omega $" src="form_30.png"/> angle.</li>
</ul>
<div class="image">
<img src="docs/associate_figs/angles/omega.pdf" alt="omega.pdf"/>
</div>
<hr/>
<h1><a class="anchor" id="examples"></a>
Examples</h1>
<h2><a class="anchor" id="homo"></a>
Homogenous Association</h2>
<ul>
<li>AP2 associationg with a clathrin-AP2 complex <div class="image">
<img src="ap2_example.pdf" alt="ap2_example.pdf"/>
</div>
</li>
</ul>
<h2><a class="anchor" id="hetero"></a>
Heterogenous Association</h2>
<ul>
<li>Clathrins associating with each other <div class="image">
<img src="pucker_clat_example.pdf" alt="pucker_clat_example.pdf"/>
</div>
</li>
</ul>
<hr/>
<h1><a class="anchor" id="Math"></a>
Math</h1>
<h2><a class="anchor" id="Quaternions"></a>
Quaternions</h2>
<p>The algorithm uses quaternions for all rotations</p>
<h3><a class="anchor" id="intro"></a>
Introduction</h3>
<blockquote class="doxtable">
<p>Quaternions came from Hamilton after his really good work had been done; and, though beautifully ingenious, have been an unmixed evil to those who have touched them in any way...</p><ul>
<li>Lord Kelvin, 1892 </li>
</ul>
</blockquote>
<ul>
<li>Number system which extends complex numbers</li>
<li>Equivalent to the quotient of two vectors, expressed in the form <img class="formulaInl" alt="$ a + b\mathbf{i} + c\mathbf{j} + d\mathbf{k}$" src="form_5.png"/>, where <img class="formulaInl" alt="$ a,~b,~c,$" src="form_6.png"/> and <img class="formulaInl" alt="$d$" src="form_7.png"/> are real numbers and <img class="formulaInl" alt="$\mathbf{i},~\mathbf{j},$" src="form_8.png"/> and <img class="formulaInl" alt="$\mathbf{k}$" src="form_9.png"/> are fundamental quaternion units.<ul>
<li>Or, in the language of complex numbers, <img class="formulaInl" alt="$b\mathbf{i} + c\mathbf{j} + d\mathbf{k}$" src="form_10.png"/> is the complex part, with <img class="formulaInl" alt="$a$" src="form_11.png"/> being the real part of the quaternion <img class="formulaInl" alt="$Q$" src="form_12.png"/></li>
</ul>
</li>
<li>Relevant to rotations, quaternion multiplication is non-commutative.</li>
</ul>
<h3><a class="anchor" id="why"></a>
Why Quaternions?</h3>
<ul>
<li>Avoids gimbal lock, which can arise when using Euler angles (which may or may not be relevant in this algorithm, I'm not sure)</li>
<li>Faster (probably) and easier to read/more compact than matrices (definitely).</li>
</ul>
<h3><a class="anchor" id="rotation"></a>
Rotations with Quaternions</h3>
<ul>
<li>Axis-angle rotations, i.e. rotations through some angle <img class="formulaInl" alt="$\theta$" src="form_0.png"/> using a rotation axis <img class="formulaInl" alt="$\vec{u} = u_x\mathbf{i} + u_y\mathbf{j} + u_z\mathbf{k}$" src="form_13.png"/>, can be represented by a quaternion through Euler's formula <img class="formulaInl" alt="$\left( e^{ix} = \cos x + i\sin x \right)$" src="form_14.png"/>: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q = e^{\frac{\theta}{2}{(u_x \mathbf{i} + u_y \mathbf{j} + u_z \mathbf{k})}} = \cos\frac{\theta}{2} + (u_x \mathbf{i} + u_y \mathbf{j} + u_z \mathbf{k})\sin\frac{\theta}{2} \]" src="form_15.png"/>
</p>
</li>
<li>Must use half angles for association, e.g. <img class="formulaInl" alt="$\frac{\theta}{2}$" src="form_16.png"/> instead of <img class="formulaInl" alt="$\theta$" src="form_0.png"/>.</li>
<li><img class="formulaInl" alt="$Q (vec) Q^{-1}$" src="form_17.png"/> --&gt; rotation of vector using quaternion <img class="formulaInl" alt="$Q$" src="form_12.png"/>. <img class="formulaInl" alt="$Q^{-1}$" src="form_18.png"/> is the inverse of <img class="formulaInl" alt="$Q$" src="form_12.png"/>, <img class="formulaInl" alt="$Q = (C, w)$" src="form_19.png"/> where C is the rotation angle and w is the axis of rotation <img class="formulaInl" alt="$(a\mathbf{i} + b\mathbf{j} + c\mathbf{k})$" src="form_20.png"/>.</li>
<li>Q must be normalized for rotation. Normalizes entire thing, including C </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
